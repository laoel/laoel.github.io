<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="à ō é's blog"><meta name="keywords" content="aoe,blog,网络安全,移动安全,app,Android,iOS,à ō é,等级保护,等保测评"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.4"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.4"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><title>Android客户端安全测试指南 | à ō é</title></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Android客户端安全测试指南</h1><a id="logo" href="/.">à ō é</a><p class="description">不 怨 天  不 尤 人</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="搜索"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">Android客户端安全测试指南</h1><div class="post-meta"><a href="/2020/01/20/Android客户端安全测试指南/#comments" class="comment-count"></a><p><span class="date">Jan 20, 2020</span><span><a href="/categories/长期更新/" class="category">长期更新</a></span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><blockquote>
<p>有任何问题可留言评论，另有Excel版提供</p>
<p><a href="https://github.com/laoel/testing-guide/blob/master/02-Android客户端安全测试指南.xlsx" target="_blank" rel="noopener">https://github.com/laoel/testing-guide/blob/master/02-Android%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95%E6%8C%87%E5%8D%97.xlsx</a></p>
</blockquote>
<h3 id="客户端程序安全"><a href="#客户端程序安全" class="headerlink" title="客户端程序安全"></a>客户端程序安全</h3><h4 id="Classes-dex文件代码加密混淆保护"><a href="#Classes-dex文件代码加密混淆保护" class="headerlink" title="Classes.dex文件代码加密混淆保护"></a>Classes.dex文件代码加密混淆保护</h4><p><strong>漏洞级别</strong><br>高/中<br><strong>漏洞描述</strong><br>对客户端程序反编译文件DEX进行转换，查看客户端是否对JAVA源生代码进 行加密混淆，是否能看到清晰的JAVA代码。</p>
<p><strong>漏洞危害</strong><br>程序代码可以被轻松反编译，攻击者可逆向工程分析程序运行原理、漏洞挖掘。<br><strong>修复建议</strong><br>1、对关键代码进行加密混淆。<br>2、使用第三方平台对APK进行加固。</p>
<h4 id="So文件代码加密混淆保护"><a href="#So文件代码加密混淆保护" class="headerlink" title="So文件代码加密混淆保护"></a>So文件代码加密混淆保护</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>利用工具反编译 so 文件，查看客户端是否对 C/C++源生代码进行加密混淆。<br><strong>漏洞危害</strong><br>应用程序关键代码明文暴露降低了攻击者入侵和利用的门槛，攻击者或恶意程序可通过修改代码获取关键信息或绕过部分逻辑直接操作。<br><strong>修复建议</strong><br>1、对关键代码进行加密混淆。<br>2、使用第三方平台对APK进行加固。</p>
<h4 id="敏感文件加密保护"><a href="#敏感文件加密保护" class="headerlink" title="敏感文件加密保护"></a>敏感文件加密保护</h4><p><strong>漏洞级别</strong><br>高/中/低<br><strong>漏洞描述</strong><br>查看客户端中的敏感文件是否加密保存，包括但不限于JavaScript、Lua、Python等脚本代码，xml、ini等关键配置文件，证书文件及开发残留文件。<br><strong>漏洞危害</strong><br>攻击者容易根据明文的敏感文件对APP进行逆向工作，从而还原出APP通信内容、APP的私钥等关键数据。<br><strong>修复建议</strong><br>1、对敏感数据进行加密处理。<br>2、对于不必要的数据不要在本地客户端。</p>
<h4 id="文件完整性校验"><a href="#文件完整性校验" class="headerlink" title="文件完整性校验"></a>文件完整性校验</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>检测客户端程序是否对自身完整性进行校验。<br><strong>漏洞危害</strong><br>攻击者能够通过反编译的方法在客户端程序中植入自己的木马，客户端程序如果没有自校验机制的话，攻击者可能会通过篡改客户端程序窃取手机用户的隐私信息。<br><strong>修复建议</strong><br>1、建议使用CRC、MD5或者SHA1等算法方式对APK文件进行完整性校验。<br>2、使用第三方平台对APK进行加固。</p>
<h4 id="硬编码安全"><a href="#硬编码安全" class="headerlink" title="硬编码安全"></a>硬编码安全</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>在计算机程序或文本编辑中，硬编码是指将可变变量用一个固定值来代替的方法。密钥硬编码在代码中，而根据密钥的用途不同，这导致了不同的安全风险，有的导致加密数据被破解，数据不再保密，有的导致和服务器通信的加签被破解，引发各种血案。<br><strong>漏洞危害</strong><br>导致加密数据被破解。<br><strong>修复建议</strong><br>1、不要使用硬编码。<br>2、应对密码加密存储，并且在外部资源文件中进行处理。</p>
<h4 id="使用不安全的加密算法"><a href="#使用不安全的加密算法" class="headerlink" title="使用不安全的加密算法"></a>使用不安全的加密算法</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>检测客户端程序使用的加密算法是否安全可靠。<br><strong>漏洞危害</strong><br>导致加密数据被破解。<br><strong>修复建议</strong><br>使用安全且不易被破解的加密算法。</p>
<h4 id="debug调试属性未关闭"><a href="#debug调试属性未关闭" class="headerlink" title="debug调试属性未关闭"></a>debug调试属性未关闭</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序是否开启debug调试属性。<br><strong>漏洞危害</strong><br>APP可被Java调试工具进行调试，进而获取和篡改用户敏感信息，甚至分析并且修改代码实现的业务逻辑。<br><strong>修复建议</strong><br>将AndroidManifest.xml文件中android:debuggable属性值设为false。</p>
<h4 id="allowBackup备份安全"><a href="#allowBackup备份安全" class="headerlink" title="allowBackup备份安全"></a>allowBackup备份安全</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序是否开启allowBackup备份属性。<br><strong>漏洞危害</strong><br>攻击者可通过adb backup和adb restore对APP的应用数据进行备份和恢复,从而可能获取明文存储的用户敏感信息。<br><strong>修复建议</strong><br>将AndroidManifest.xml文件中android:allowBakup属性值设为false。</p>
<h4 id="应用权限测试"><a href="#应用权限测试" class="headerlink" title="应用权限测试"></a>应用权限测试</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检测客户端程序是否存在敏感权限。<br><strong>漏洞危害</strong><br>APP应用应只拥有所需功能的最小行为权限，多余的行为权限对APP的安全造成危害，同时容易被安全检测工具认定为恶意APP。<br><strong>修复建议</strong><br>请确认APP应用是否需要这些权限，如果不需要，请删除多余的权限。</p>
<h4 id="Activity-界面劫持"><a href="#Activity-界面劫持" class="headerlink" title="Activity 界面劫持"></a>Activity 界面劫持</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检查是否存在Activity界面劫持风险，确认客户端是否能够发现并提示用户存在劫持。<br><strong>漏洞危害</strong><br>Activity界面劫持可以获取用户输入的敏感信息，如账号、密码。<br><strong>修复建议</strong><br>当主activity退到后台后，推送Toast弹框消息提示用户，程序已经进入后台运行。</p>
<h3 id="组件安全"><a href="#组件安全" class="headerlink" title="组件安全"></a>组件安全</h3><h4 id="Activity组件安全"><a href="#Activity组件安全" class="headerlink" title="Activity组件安全"></a>Activity组件安全</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检测Activity组件是否允许非授权的第三方调用。<br><strong>漏洞危害</strong><br>Activity组件允许非授权的第三方调用可能会引发权限绕过漏洞，攻击者可以未授权获取敏感信息或者进行非法操作。<br><strong>修复建议</strong><br>建议在AndroidManifest.xml中设置所有不允许导出的Activity组件exported属性为false。</p>
<h4 id="Service组件安全"><a href="#Service组件安全" class="headerlink" title="Service组件安全"></a>Service组件安全</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检测Service组件是否允许非授权的第三方调用。<br><strong>漏洞危害</strong><br>Service组件允许非授权的第三方调用可能会引发权限绕过漏洞，攻击者可以未授权获取敏感信息或者进行非法操作。<br><strong>修复建议</strong><br>建议在AndroidManifest.xml中设置所有不允许导出的Service组件exported属性为false。</p>
<h4 id="Broadcast-Receiver组件安全"><a href="#Broadcast-Receiver组件安全" class="headerlink" title="Broadcast Receiver组件安全"></a>Broadcast Receiver组件安全</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检测Broadcast Receiver组件是否允许非授权的第三方调用。<br><strong>漏洞危害</strong><br>Broadcast Receiver组件允许非授权的第三方调用可能会引发权限绕过漏洞，攻击者可以未授权获取敏感信息或者进行非法操作。<br><strong>修复建议</strong><br>建议在AndroidManifest.xml中设置所有不允许导出的Broadcast Receiver组件exported属性为false。</p>
<h4 id="Content-Provider组件安全"><a href="#Content-Provider组件安全" class="headerlink" title="Content Provider组件安全"></a>Content Provider组件安全</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检测Content Provider组件是否允许非授权的第三方调用。<br><strong>漏洞危害</strong><br>Content Provider组件允许非授权的第三方调用可能会引发权限绕过漏洞，攻击者可以未授权获取敏感信息或者进行非法操作。<br><strong>修复建议</strong><br>建议在AndroidManifest.xml中设置所有不允许导出的Content Provider组件exported属性为false。</p>
<h3 id="数据安全"><a href="#数据安全" class="headerlink" title="数据安全"></a>数据安全</h3><h4 id="Shared-Prefs敏感信息保护"><a href="#Shared-Prefs敏感信息保护" class="headerlink" title="Shared_Prefs敏感信息保护"></a>Shared_Prefs敏感信息保护</h4><p><strong>漏洞级别</strong><br>高/中<br><strong>漏洞描述</strong><br>APP在处理运行时产生的敏感数据（如账号、密码、手机号、Cookie、Token等业务相关敏感信息）时，将未经加密的敏感信息以明文的形式保存在文件或者本地数据库中。<br><strong>漏洞危害</strong><br>当用户手机失窃或者连接到电脑等情况时，这些明文的敏感数据可能被第三方程序获取，导致用户的账号、密码、手势密码、手机号等个人敏感信息容易泄露。<br><strong>修复建议</strong><br>1、使用安全有效的加密算法对敏感信息进行加密保护。<br>2、根据业务需求确定必需在本地存储的数据，不存储非必要的数据。</p>
<h4 id="本地数据库明文存储敏感信息"><a href="#本地数据库明文存储敏感信息" class="headerlink" title="本地数据库明文存储敏感信息"></a>本地数据库明文存储敏感信息</h4><p><strong>漏洞级别</strong><br>高/中<br><strong>漏洞描述</strong><br>APP在处理运行时产生的敏感数据（如账号、密码、手机号、Cookie、Token等业务相关敏感信息）时，将未经加密的敏感信息以明文的形式保存在本地数据库中。<br><strong>漏洞危害</strong><br>当用户手机失窃或者连接到电脑等情况时，这些明文的敏感数据可能被第三方程序获取，导致用户的账号、密码、手势密码、手机号等个人敏感信息容易泄露。<br><strong>修复建议</strong><br>1、使用安全有效的加密算法对敏感信息进行加密保护。<br>2、根据业务需求确定必需在本地存储的数据，不存储非必要的数据。</p>
<h4 id="Log日志打印敏感信息"><a href="#Log日志打印敏感信息" class="headerlink" title="Log日志打印敏感信息"></a>Log日志打印敏感信息</h4><p><strong>漏洞级别</strong><br>高/中<br><strong>漏洞描述</strong><br>检测Logcat日志安全性。<br><strong>漏洞危害</strong><br>存在用户个人敏感信息泄露的风险。<br><strong>修复建议</strong><br>在发布程序之前屏蔽掉敏感的Log日志信息，或者使用统一的Log控制类，屏蔽掉所有敏感信息的输出。</p>
<h3 id="应用安全规范"><a href="#应用安全规范" class="headerlink" title="应用安全规范"></a>应用安全规范</h3><h4 id="使用自带安全软键盘完成敏感输入"><a href="#使用自带安全软键盘完成敏感输入" class="headerlink" title="使用自带安全软键盘完成敏感输入"></a>使用自带安全软键盘完成敏感输入</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>检测客户端程序在输入敏感数据时是否使用自带安全软键盘。<br><strong>漏洞危害</strong><br>安卓应用中的输入框默认使用系统软键盘，手机安装木马后，木马可以通过替换系统软键盘，记录手机键盘输过的密码。<br><strong>修复建议</strong><br>使用APP自定义的安全软键盘（而非系统输入法）来输入敏感信息。</p>
<h4 id="敏感界面截屏和录屏保护"><a href="#敏感界面截屏和录屏保护" class="headerlink" title="敏感界面截屏和录屏保护"></a>敏感界面截屏和录屏保护</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序的敏感界面是否可防止屏幕截屏和录屏。<br><strong>漏洞危害</strong><br>录屏和截屏是黑客窃取用户隐私的又一手段，通过对用户敏感界面的截取而窃取用户的登录、支付的信息从而造成客户的损失。<br><strong>修复建议</strong><br>对于APP的业务敏感界面，禁止系统进行截屏和录屏。</p>
<h4 id="应用后台运行模糊处理保护"><a href="#应用后台运行模糊处理保护" class="headerlink" title="应用后台运行模糊处理保护"></a>应用后台运行模糊处理保护</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序后台运行的APP界面是否进行了模糊处理。<br><strong>漏洞危害</strong><br>可能产生一定的信息泄露风险。<br><strong>修复建议</strong><br>后台运行APP时，界面增加模糊处理。</p>
<h4 id="ROOT环境检测"><a href="#ROOT环境检测" class="headerlink" title="ROOT环境检测"></a>ROOT环境检测</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检测客户端程序是否可以在ROOT设备上运行。<br><strong>漏洞危害</strong><br>APP应用应禁止安装在已ROOT的移动设备中，已ROOT的移动设备会对APP应用的安全性造成巨大的影响。<br><strong>修复建议</strong><br>1、禁止APP在ROOT设备上运行。<br>2、若确实需要在ROOT环境中运行，应对用户提出安全警告。</p>
<h4 id="模拟器环境检测"><a href="#模拟器环境检测" class="headerlink" title="模拟器环境检测"></a>模拟器环境检测</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序是否可以在模拟器中运行。<br><strong>漏洞危害</strong><br>攻击者可以通过自己修改定制特定的模拟器来达到监控应用关键函数、获取应用敏感数据，破解应用的目的。<br><strong>修复建议</strong><br>防止APP在模拟机中运行，当监听到处于模拟器时，禁止启动。检测内容，设备 IDS、imsi id，硬件信息，模拟器特有的文件等。</p>
<h3 id="账号安全"><a href="#账号安全" class="headerlink" title="账号安全"></a>账号安全</h3><h4 id="密码复杂度检测"><a href="#密码复杂度检测" class="headerlink" title="密码复杂度检测"></a>密码复杂度检测</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序是否允许使用弱密码。<br><strong>漏洞危害</strong><br>攻击者可爆破口令，从而可得出正确的口令，冒用其身份进行登录。<br><strong>修复建议</strong><br>建议设置密码复杂度，密码长度8-20位并且由数字、字母或字符组成，至少两种。</p>
<h4 id="单点登录限制"><a href="#单点登录限制" class="headerlink" title="单点登录限制"></a>单点登录限制</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>测试一个账号是否可以同时在多个设备上登录APP应用进行操作。<br><strong>漏洞危害</strong><br>攻击者可冒用用户账号登录APP。<br><strong>修复建议</strong><br>若无业务需求，应当限制单点登录。</p>
<h4 id="账号锁定策略检测"><a href="#账号锁定策略检测" class="headerlink" title="账号锁定策略检测"></a>账号锁定策略检测</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序是否限制登录尝试次数。<br><strong>漏洞危害</strong><br>攻击者可以使用穷举法暴力破解账号密码。<br><strong>修复建议</strong><br>设置账号登录失败锁定策略，如登录失败5次锁定账号10分钟。</p>
<h4 id="UI信息泄露"><a href="#UI信息泄露" class="headerlink" title="UI信息泄露"></a>UI信息泄露</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序是否存在敏感信息泄露问题。<br><strong>漏洞危害</strong><br>若用户的手机号、身份证号等敏感信息全部明文显示，易造成用户信息泄露。<br><strong>修复建议</strong><br>1、对用户敏感数据进行脱敏处理。<br>2、统一登录界面的错误回显信息。</p>
<h4 id="验证码安全"><a href="#验证码安全" class="headerlink" title="验证码安全"></a>验证码安全</h4><p><strong>漏洞级别</strong><br>低<br><strong>漏洞描述</strong><br>检测客户端程序在注册/登录/找回密码等操作时是否使用验证码校验技术。<br><strong>漏洞危害</strong><br>容易造成攻击者暴力破解账号密码。<br><strong>修复建议</strong><br>1、对于一些敏感操作，使用安全有效的验证码机制。<br>2、在服务器端实时刷新与校验验证码，确保验证码不能被重复使用或置空验证码参数和值。</p>
<h4 id="安全注销"><a href="#安全注销" class="headerlink" title="安全注销"></a>安全注销</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>测试APP应用会话注销是否能正常终止会话。<br><strong>漏洞危害</strong><br>不安全的注销机制可能允许应用退出后再次启用上次会话。<br><strong>修复建议</strong><br>在服务器端实时校验用户登录状态。用户退出后，用户凭证应立即失效，用户第二次登录后的用户凭证应当与先前登录时的用户凭证不同。</p>
<h4 id="双因子认证检测"><a href="#双因子认证检测" class="headerlink" title="双因子认证检测"></a>双因子认证检测</h4><p><strong>漏洞级别</strong><br>中/低<br><strong>漏洞描述</strong><br>检测客户端程序是否对账户进行双因子认证。<br><strong>漏洞危害</strong><br>采用单因子认证容易出现凭证被窃取冒用的风险。<br><strong>修复建议</strong><br>建议APP提供多因子认证功能，如采用短信验证码、PIN码、手势密码、指纹解锁、人脸识别等鉴别技术。</p>
<h4 id="手势密码绕过"><a href="#手势密码绕过" class="headerlink" title="手势密码绕过"></a>手势密码绕过</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>检测客户端程序的手势密码可否被绕过。<br><strong>漏洞危害</strong><br>APP的手势密码可能会存在绕过等问题。<br><strong>修复建议</strong><br>根据漏洞情况给出对应的建议。</p>
<h4 id="手势密码本地信息保存"><a href="#手势密码本地信息保存" class="headerlink" title="手势密码本地信息保存"></a>手势密码本地信息保存</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>检测在输入手势密码以后客户端是否会在本地记录一些相关信息，例如明文或加密过的手势密码，包括运行日志中是否会泄露手势密码。<br><strong>漏洞危害</strong><br>明文存储的手势密码会导致信息泄露。<br><strong>修复建议</strong><br>本地存储的手势密码一定要使用安全有效的加密算法进行加密保护。</p>
<h3 id="通信安全"><a href="#通信安全" class="headerlink" title="通信安全"></a>通信安全</h3><h4 id="通信协议检测"><a href="#通信协议检测" class="headerlink" title="通信协议检测"></a>通信协议检测</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检测客户端和服务端通信采用什么协议进行传输。<br><strong>漏洞危害</strong><br>业务敏感信息明文传输，采用HTTP协议传输，易造成信息泄露。<br><strong>修复建议</strong><br>部署HTTPS、SSL/TLS协议。</p>
<h4 id="证书有效性检测"><a href="#证书有效性检测" class="headerlink" title="证书有效性检测"></a>证书有效性检测</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>检查服务端证书是否是CA签发，客户端程序和服务器端的SSL通信是否严格检查服务器端证书的有效性。<br><strong>漏洞危害</strong><br>业务敏感信息明文传输，易被中间人劫持，造成信息泄露。<br><strong>修复建议</strong><br>采用SSL/TLS双向验证，防止抓包等操作。</p>
<h4 id="关键数据加密和校验"><a href="#关键数据加密和校验" class="headerlink" title="关键数据加密和校验"></a>关键数据加密和校验</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>测试客户端程序提交数据给服务端时，密码等关键字段是否进行了加密，防止恶意用户嗅探到用户数据包中的密码等敏感信息。<br><strong>漏洞危害</strong><br>业务敏感信息明文传输，易被中间人劫持，造成信息泄露。<br><strong>修复建议</strong><br>1、使用较为安全的加密算法，诸如非对称加密算法等对传输过程中的用户名、密码、银行卡号等业务敏感信息进行加密处理。<br>2、部署HTTPS协议。</p>
<h3 id="业务安全"><a href="#业务安全" class="headerlink" title="业务安全"></a>业务安全</h3><h4 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>SQL注入是将Web页面的原URL、表单域或数据包输入的参数，修改拼接成SQL语句，传递给Web服务器，进而传给数据库服务器以执行数据库命令。<br><strong>漏洞危害</strong><br>恶意攻击者可能会利用SQL注入漏洞获取、篡改数据库数据，执行系统命令，甚至获取系统控制权限。<br><strong>修复建议</strong><br>1、使用全局过滤器，过滤特殊字符，正确处理数据类型。包括但不限于以下字符及字符串：select and or like regxpfrom where update exec order by having drop delete ( ) [ ] &lt; &gt; , . ; : ‘“ # % + - _ = / * @。<br>2、预编译SQL语句，而不要动态组装SQL语句，否则必须确保在使用输入的数据组装成SQL语句之前，对特殊字符进行预处理。<br>3、以最小权限执行SQL语句，限制远程连接数据库的IP地址范围。<br>4、屏蔽错误回显，必要时，限制长度。</p>
<h4 id="XSS跨站脚本攻击"><a href="#XSS跨站脚本攻击" class="headerlink" title="XSS跨站脚本攻击"></a>XSS跨站脚本攻击</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>跨站脚本攻击，是目前最普遍的Web应用安全漏洞。这类漏洞能够使得攻击者嵌入恶意脚本代码到正常用户会访问到的页面中，当正常用户访问该页面时，则可导致嵌入的恶意脚本代码的执行，从而达到恶意攻击用户的目的。<br><strong>漏洞危害</strong><br>攻击者利用XSS，不仅能够进行钓鱼，窃取用户会话，网站挂马，甚至能够直接控制浏览器，或者引发蠕虫攻击。<br><strong>修复建议</strong><br>1、检查所有用户输入数据的地方是否有进行过滤或转义处理。包括但不限于这些字符：Javascript script src img onerror { } ( ) &lt; &gt; = , . ; :  “ ‘ # ! / * \。<br>2、根据页面的输出背景环境，对输出进行编码或使用一个统一的规则和库做输出编码，使用安全框架进行安全编码。<br>3、对于富文本框，尽量使用白名单控制输入，而不是黑名单。<br>4、配置httpOnly,必要时，限制输入字符的长度。</p>
<h4 id="任意文件上传"><a href="#任意文件上传" class="headerlink" title="任意文件上传"></a>任意文件上传</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>文件上传漏洞是指由于系统未对上传的文件进行严格的验证和过滤，而导致的用户可以越过其本身权限向服务器上传可执行的动态脚本文件。<br><strong>漏洞危害</strong><br>上传恶意脚本，获取信息、控制网站，甚至控制服务器。<br><strong>修复建议</strong><br>1、在服务器上使用白名单对上传的文件进行严格的验证，只允许上传特定的文件类型。验证包括文件扩展名校验、文件类型（Content-Type）校验、MIME类型校验、文件头校验等等。<br>2、文件上传的存储目录禁用执行权限。<br>3、使用随机数改写文件名和文件路径，让用户不能轻易访问自己上传的文件。</p>
<h4 id="弱口令漏洞"><a href="#弱口令漏洞" class="headerlink" title="弱口令漏洞"></a>弱口令漏洞</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>应用存在默认口令或口令较简单易被猜到。<br><strong>漏洞危害</strong><br>攻击者可以通过暴力破解等方法得到正确的账号，从而冒用他人身份进入系统。<br><strong>修复建议</strong><br>1、统一错误回显，如只提示用户名或密码错误。<br>2、使用安全有效的验证码校验机制。<br>3、配置账号锁定策略，如错误登录3次以上锁定该账号10分钟。</p>
<h4 id="越权访问"><a href="#越权访问" class="headerlink" title="越权访问"></a>越权访问</h4><p><strong>漏洞级别</strong><br>高<br><strong>漏洞描述</strong><br>网站的页面权限控制不当，用户可访问不属于自己的页面并可修改数据。<br><strong>漏洞危害</strong><br>权限控制不当，会造成网站数据非法篡改等危害。<br><strong>修复建议</strong><br>1、验证一切来自客户端的参数，重点是和权限相关的参数，比如用户ID或者角色权限ID等。<br>2、Session ID 和认证的Token做绑定，放在服务器的会话里，不发送给客户端。<br>3、对于用户登录后涉及用户唯一信息的请求，每次都要验证检查所有权，敏感信息页面加随机数的参数，防止浏览器缓存内容。</p>
<h4 id="短信轰炸"><a href="#短信轰炸" class="headerlink" title="短信轰炸"></a>短信轰炸</h4><p><strong>漏洞级别</strong><br>中<br><strong>漏洞描述</strong><br>攻击者可以对指定手机号码进行短信轰炸，对用户造成骚扰的同时，也消耗了服务器资源。<br><strong>漏洞危害</strong><br>对用户造成短信骚扰，同时消耗服务器资源。<br><strong>修复建议</strong><br>1、在服务器端限制发送短信的时间间隔至少为60秒以上。<br>2、发送短信验证码之前添加图形验证码校验。<br>3、限制24小时内，针对同一手机号码发送验证码的总次数。<br>4、限制单个IP地址24小时内请求验证码的次数。</p>
</div><div class="post-copyright"><blockquote><p>原文作者: à ō é</p><p>原文链接: <a href="https://laoel.github.io/2020/01/20/Android客户端安全测试指南/">https://laoel.github.io/2020/01/20/Android客户端安全测试指南/</a></p><p>版权声明: 转载请注明出处(必须保留原文作者署名原文链接)</p></blockquote></div><div class="tags"><a href="/tags/修复建议/">修复建议</a><a href="/tags/Android漏洞/">Android漏洞</a><a href="/tags/漏洞库/">漏洞库</a><a href="/tags/测试指南/">测试指南</a></div><div class="post-share"><div class="social-share"><span>分享到:</span></div></div><div class="post-nav"><a href="/2020/03/16/等保2-0-安全通信网络/" class="pre">等保2.0-安全通信网络</a><a href="/2020/01/09/Web常见漏洞库-v1-0/" class="next">Web常见漏洞库-v1.0</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#客户端程序安全"><span class="toc-text">客户端程序安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Classes-dex文件代码加密混淆保护"><span class="toc-text">Classes.dex文件代码加密混淆保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#So文件代码加密混淆保护"><span class="toc-text">So文件代码加密混淆保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#敏感文件加密保护"><span class="toc-text">敏感文件加密保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#文件完整性校验"><span class="toc-text">文件完整性校验</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#硬编码安全"><span class="toc-text">硬编码安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用不安全的加密算法"><span class="toc-text">使用不安全的加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#debug调试属性未关闭"><span class="toc-text">debug调试属性未关闭</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#allowBackup备份安全"><span class="toc-text">allowBackup备份安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#应用权限测试"><span class="toc-text">应用权限测试</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Activity-界面劫持"><span class="toc-text">Activity 界面劫持</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#组件安全"><span class="toc-text">组件安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Activity组件安全"><span class="toc-text">Activity组件安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Service组件安全"><span class="toc-text">Service组件安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Broadcast-Receiver组件安全"><span class="toc-text">Broadcast Receiver组件安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Content-Provider组件安全"><span class="toc-text">Content Provider组件安全</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据安全"><span class="toc-text">数据安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Shared-Prefs敏感信息保护"><span class="toc-text">Shared_Prefs敏感信息保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#本地数据库明文存储敏感信息"><span class="toc-text">本地数据库明文存储敏感信息</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Log日志打印敏感信息"><span class="toc-text">Log日志打印敏感信息</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#应用安全规范"><span class="toc-text">应用安全规范</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#使用自带安全软键盘完成敏感输入"><span class="toc-text">使用自带安全软键盘完成敏感输入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#敏感界面截屏和录屏保护"><span class="toc-text">敏感界面截屏和录屏保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#应用后台运行模糊处理保护"><span class="toc-text">应用后台运行模糊处理保护</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ROOT环境检测"><span class="toc-text">ROOT环境检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#模拟器环境检测"><span class="toc-text">模拟器环境检测</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#账号安全"><span class="toc-text">账号安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#密码复杂度检测"><span class="toc-text">密码复杂度检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#单点登录限制"><span class="toc-text">单点登录限制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#账号锁定策略检测"><span class="toc-text">账号锁定策略检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#UI信息泄露"><span class="toc-text">UI信息泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#验证码安全"><span class="toc-text">验证码安全</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#安全注销"><span class="toc-text">安全注销</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#双因子认证检测"><span class="toc-text">双因子认证检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#手势密码绕过"><span class="toc-text">手势密码绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#手势密码本地信息保存"><span class="toc-text">手势密码本地信息保存</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#通信安全"><span class="toc-text">通信安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#通信协议检测"><span class="toc-text">通信协议检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#证书有效性检测"><span class="toc-text">证书有效性检测</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#关键数据加密和校验"><span class="toc-text">关键数据加密和校验</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#业务安全"><span class="toc-text">业务安全</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL注入"><span class="toc-text">SQL注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#XSS跨站脚本攻击"><span class="toc-text">XSS跨站脚本攻击</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#任意文件上传"><span class="toc-text">任意文件上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#弱口令漏洞"><span class="toc-text">弱口令漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#越权访问"><span class="toc-text">越权访问</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#短信轰炸"><span class="toc-text">短信轰炸</span></a></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/07/01/安全圈里的公众号推荐/">安全圈里的公众号推荐</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/28/Apache安全加固/">Apache安全加固</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/16/等保2-0-安全通信网络/">等保2.0-安全通信网络</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/20/Android客户端安全测试指南/">Android客户端安全测试指南</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/09/Web常见漏洞库-v1-0/">Web常见漏洞库-v1.0</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/04/一文搞定LNMP环境的搭建/">一文搞定LNMP环境的搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/20/一些配置小记/">一些配置小记</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/16/在server-2012中部署weblogic/">在server 2012中部署weblogic</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/09/在ubuntu18-04上安装和配置Apache2/">在ubuntu18.04上安装和配置Apache2</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/06/cve-2019-0708漏洞复现/">cve-2019-0708漏洞复现</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/markdown/">markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/兴趣爱好/">兴趣爱好</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/安全加固/">安全加固</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/安装配置/">安装配置</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂文/">杂文</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/漏洞复现/">漏洞复现</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/等保测评/">等保测评</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/长期更新/">长期更新</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/面试/">面试</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/书籍推荐/" style="font-size: 15px;">书籍推荐</a> <a href="/tags/CFOP公式/" style="font-size: 15px;">CFOP公式</a> <a href="/tags/apache/" style="font-size: 15px;">apache</a> <a href="/tags/加固/" style="font-size: 15px;">加固</a> <a href="/tags/中间件/" style="font-size: 15px;">中间件</a> <a href="/tags/web漏洞/" style="font-size: 15px;">web漏洞</a> <a href="/tags/修复建议/" style="font-size: 15px;">修复建议</a> <a href="/tags/CVE/" style="font-size: 15px;">CVE</a> <a href="/tags/杂文/" style="font-size: 15px;">杂文</a> <a href="/tags/博客/" style="font-size: 15px;">博客</a> <a href="/tags/小技巧/" style="font-size: 15px;">小技巧</a> <a href="/tags/环境搭建/" style="font-size: 15px;">环境搭建</a> <a href="/tags/LNMP/" style="font-size: 15px;">LNMP</a> <a href="/tags/Apache/" style="font-size: 15px;">Apache</a> <a href="/tags/配置/" style="font-size: 15px;">配置</a> <a href="/tags/公众号/" style="font-size: 15px;">公众号</a> <a href="/tags/安全圈/" style="font-size: 15px;">安全圈</a> <a href="/tags/魔方/" style="font-size: 15px;">魔方</a> <a href="/tags/摘录/" style="font-size: 15px;">摘录</a> <a href="/tags/技术文章/" style="font-size: 15px;">技术文章</a> <a href="/tags/网络安全/" style="font-size: 15px;">网络安全</a> <a href="/tags/信息安全/" style="font-size: 15px;">信息安全</a> <a href="/tags/漏洞/" style="font-size: 15px;">漏洞</a> <a href="/tags/漏洞预警/" style="font-size: 15px;">漏洞预警</a> <a href="/tags/md/" style="font-size: 15px;">md</a> <a href="/tags/markdown/" style="font-size: 15px;">markdown</a> <a href="/tags/语法介绍/" style="font-size: 15px;">语法介绍</a> <a href="/tags/安装/" style="font-size: 15px;">安装</a> <a href="/tags/weblogic/" style="font-size: 15px;">weblogic</a> <a href="/tags/面试经验/" style="font-size: 15px;">面试经验</a> <a href="/tags/渗透测试/" style="font-size: 15px;">渗透测试</a> <a href="/tags/等保/" style="font-size: 15px;">等保</a> <a href="/tags/Android漏洞/" style="font-size: 15px;">Android漏洞</a> <a href="/tags/漏洞库/" style="font-size: 15px;">漏洞库</a> <a href="/tags/测试指南/" style="font-size: 15px;">测试指南</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> 友情链接</i></div><ul></ul><a href="http://iosre.com" title="iOSRE | 逆" target="_blank">iOSRE | 逆</a><ul></ul><a href="https://www.bugbank.cn" title="漏洞银行" target="_blank">漏洞银行</a><ul></ul><a href="http://www.wjdiankong.cn" title="尼古拉斯.赵四" target="_blank">尼古拉斯.赵四</a><ul></ul><a href="https://www.exploit-db.com" title="Exploit Database" target="_blank">Exploit Database</a><ul></ul><a href="http://a--o--e.lofter.com" title="以前的博客" target="_blank">以前的博客</a><ul></ul><a href="https://bbs.ichunqiu.com/home.php?mod=space&amp;uid=272066&amp;do=thread&amp;view=me&amp;from=space" title="在i春秋社区发布的一些帖子" target="_blank">在i春秋社区发布的一些帖子</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |  <a href="/atom.xml">订阅本站</a> |  <a href="/about/">联系博主</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">à ō é.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?a5e9eb180965a7958e3fe088b78b163c";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="/js/search.json.js?v=2.0.4"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});</script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML" async></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.4" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script></body></html>